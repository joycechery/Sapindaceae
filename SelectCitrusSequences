
###get the intron sizes for each mrna
grep 'mRNA' Csinensis_v1.0_gene.gff3 | awk '{print $9}' | awk 'BEGIN{FS= ";"}{print $4}' > mrnaNames
perl get_intronsize.pl Csinensis_v1.0_gene.gff3  > intronsize
paste mrnaNames intronsize > mrnaIntronSize

###get the single isoform genes from the intron size file
sort mrnaNames | uniq -c | sort | awk '$1<2' | awk '{print $2}' > singlemrnaNames
grep -f singlemrnaNames  mrnaIntronSize > singlemRNAintrons

###sort for mrna with introns of 500-1100 base pairs according to intron file
awk '$4>500&&$4<1100' singlemRNAintrons > singlemRNAintrons_small 
awk '$5>500&&$5<1100' singlemRNAintrons >> singlemRNAintrons_small  
... do this for however many columns necessary

###uniq and sort through small introns list to generate a list of sequences to Align transcriptome reads to
sort singlemRNAintrons_small | uniq | awk '{print $2}' > singlemRNAintrons_small_uniq
awk '{FS =";"}{print $4}' singlemRNAintrons_small_uniq | sed 's/Parent=//' | sed 's/m.g/m/' > unique_mrna_genesname
